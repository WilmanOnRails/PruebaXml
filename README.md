# PruebaXml
## Harry si lees esto chupala 
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠟⠋⠉⠉⠛⠻⢿⣿⠿⠛⠋⠁⠈⠙
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠁⠴⣿⠟⠉⠀⠀⠈⡀⠀⠀⠀⠀⠀⠀
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠋⠀⣾⣿⣿⣿⣿⣿⠿⠿⠿⠛⠛⠉⠉⠀⠀⠀⠀⠀⠀⠀⠉⢁⠀⠀⠈⠀⠀⠀⠀⢀⡇⠀⠀⠀⠀⠀⠀
⣿⣿⣿⣿⣿⣿⣿⣿⣿⡏⠀⠀⣀⣿⠿⠛⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⡀⠀⠀⠀⢀⣠⣾⣿⠀⠀⠐⢦⡀⠀
⣿⣿⣿⣿⣿⣿⣿⣿⣿⡀⣠⡾⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⣤⣤⣄⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠛⠻⠿⠿⠟⠛⠋⢷⣄⠀⠀⠹⣦
⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡟⠛⠛⠛⠛⠯⠶⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠻⣷⣤⡀⠘
⣿⣿⣿⣿⣿⣿⣿⡿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠉⠑⠢⣀⠈⠢⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⣿⣿⣷
⣿⣿⣿⣿⣿⣿⠏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⠀⠀⡇⠀⠀⠀⣀⠄⠒⠀⠀⠀⠀⠀⠑⠢⡙⡳⣄⠀⠀⠀⠈⠀⠀⠀⠀⠈⠻⣿
⣿⣿⣿⣿⡿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⡆⠀⠃⢀⡴⠚⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠱⠈⠳⡄⠀⠀⠀⢂⠀⠀⠀⠀⠘
⣿⣿⣿⡿⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⣾⡀⢐⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣀⣴⡀⠁⠀⠙⢦⠀⠀⠈⣧⡀⠀⠀⠀
⣿⣿⣿⠃⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡏⠳⡈⡀⠀⠀⠀⠀⠀⢀⣤⣶⣿⡿⠿⠽⠿⠿⣿⣷⣶⣌⡳⡀⠀⢹⣷⡄⠀⠀
⣿⡟⠁⠀⠀⠀⠀⣷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀⠑⢥⠀⠀⡾⠋⣰⡿⡟⠊⠀⠚⣿⣿⣿⣶⣄⠀⠉⢹⠀⢳⠀⢸⣿⣿⡄⠀
⣿⠇⠀⠀⠀⠀⠀⢹⣇⠀⠀⠀⠂⠀⠀⠀⠀⠀⠀⠀⠘⡄⠀⠈⠀⠈⠀⠰⢻⠋⠀⣀⣀⣠⣿⣿⣿⣿⣿⣇⠀⠈⠀⠀⢃⢘⡏⢿⣿⡄
⡿⠀⠀⠀⠀⠀⠀⣿⠈⠣⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢃⠀⠀⠀⠀⠀⠀⠋⠀⠀⢿⣿⣿⣿⣿⣿⡿⠟⠁⠀⠀⠀⠀⠘⣼⡇⠈⢿⣿
⡇⠀⠀⠀⠀⡆⠀⣿⠀⠀⡨⠂⠄⡀⠀⠀⠀⠠⣀⠀⠀⠘⡄⠀⠀⠀⠀⠀⠀⠀⠀⠈⠙⠻⠿⠛⠁⠀⠀⠀⠀⠀⠀⠀⠀⣿⠀⠀⠈⣿
⡇⠀⠀⠀⠀⠀⠀⢸⠀⣐⠊⠀⠀⠀⢉⠶⠶⢂⠈⠙⠒⠂⠠⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠇⠀⠀⠀⠸
⠀⣀⠂⢣⡀⠀⠀⠘⣠⠃⠀⠀⠀⠀⣠⣴⣾⠷⠤⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⡀⡙⠀⠈⢧⠀⠡⡀⢉⠀⠀⠀⠀⣴⣿⡫⣋⣥⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⡗⠃⠐⠀⠈⣷⡀⢳⡄⠂⠀⠀⣸⣿⡛⠑⠛⢿⣿⣿⣷⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⡇⡀⠂⡀⠀⣸⢱⡈⠇⠐⠄⡠⣿⡟⠁⠀⠀⣸⣿⣿⣿⡟⠀⠀⠀⠀⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⣿⡐⡀⠀⢠⠏⠀⢳⡘⡄⠈⠀⢿⡿⠀⢻⣿⣿⣿⡿⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⣿⣧⠐⢀⡏⠀⠀⠀⢳⡴⡀⠀⢸⣿⡄⠀⠉⠛⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣶⣶⣶⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⣿⣿⣆⠀⠐⡀⠀⠀⠀⢻⣷⡀⠀⠃⠙⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢿⣿⣿⣿⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⣿⣿⣿⣆⠀⠙⣄⠀⠀⠀⠱⣕⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠻⣿⣿⣿⣦⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣴
⣿⣿⣿⣿⣧⡀⠘⢦⡀⠀⠀⠈⢢⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⠿⣿⣿⣇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣾⣿
⣿⣿⣿⣿⣿⣷⢄⠈⠻⣆⠀⠀⠀⠑⢄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠛⠿⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⣾⣿⣿⣿

https://stackoverflow.com/questions/17405180/how-to-read-existing-text-files-without-defining-path

using System.Xml.Linq;


namespace ConsoleApp1
{

    [Serializable]
    public class DataBase
    {

        private XDocument document;
        private static List<Productos> listaProductos;

        static DataBase()
        {
            listaProductos = new();
        }

        public void CrearDocumento(List<Cliente> listaClientes)
        {
            if (!File.Exists(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, @"DataBaseUsers.xml")))
            {
                document = new(new XComment("DataBase of Clients"),
                    new XElement("Clientes", from cliente in listaClientes.ToArray()

                                             select new XElement("Cliente",
                                         new XAttribute("IdCliente", cliente.Id),
                                         new XElement("Nombre", cliente.Name),
                                         new XElement("Origen", cliente.Origen))));

                document.Save(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, @"DataBaseUsers.xml"));
                return;
            }

            Console.WriteLine("el documento ya existe");
            agregarCliente(listaClientes);
        }
        /*
        public void AgegarCliente(string nombre, string origen)
        {
            listaClientes.Add(new() { Name = nombre, Origen = origen });
        }
        */

        private void agregarCliente(List<Cliente> listaClientes)
        {

            if (!File.Exists(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, @"DataBaseUsers.xml"))) return;

            /* Editar de esta manera sin incrementar el Id del cliente (siempre sera 1 el id)
            edit.Element("Clientes").Add(from cliente in listaClientes.ToArray() select new 
                    XElement("Cliente", new XAttribute("IdCliente", cliente.Id),
                    new XElement("Nombre", cliente.Name),
                    new XElement("Origen", cliente.Origen)));
            */

            document.Element("Clientes").Add(from c in listaClientes
                                             select new XElement(
"Cliente", new XAttribute("IdCliente", c.Id), new XElement(
"Nombre", c.Name), new XElement("Origen", c.Origen)
));


            document.Save(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, @"DataBaseUsers.xml"));
        }

        public void MostrarClientes()
        {
            var clientes = from cliente in XDocument.Load(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, @"DataBaseUsers.xml")).
                           Descendants("Cliente")
                           select cliente;

            foreach (var item in clientes)
                Console.WriteLine($"nombre del cliente: {item.Element("Nombre").Value}, id del cliente: {item.Attribute("IdCliente").Value} , lugar de origen: {item.Element("Origen").Value}");
        }


        public void asegurarArchivo()
        {
            Console.WriteLine("encriptando...");
            //  File.SetAttributes(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, @"DataBaseUsers.xml"),  FileAttributes.Hidden);

            Productos p = new Productos(12, 10, "wilman");

            Cliente c = p;

            // esto da error --->   c.Apellido = "lul";

            var sth = getTupla("Hola", p);



            File.Encrypt(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, @"DataBaseUsers.xml"));
        }

        public void reflectClient(Cliente c)
        {
            var reflectedClient = typeof(Cliente).GetProperties();

            foreach (var item in reflectedClient)
            {
                Console.WriteLine($"Nombre: {item.Name}, tipo: {item.GetType().ToString()}," +
                    $" valor: {item.GetValue(c)?.ToString()}");
                Console.WriteLine($"es mayor {longitudCaracteres(item.Name)}");
            }

        }

        private string longitudCaracteres(string name) => name.Length switch
        {
            > 0 and <= 1 => "un caracter",
            > 1 and <= 10 => "longitud normal",
            > 10 and <= 15 => "Grande",
            > 15 => "ENORME",
            _ => ""
        };


        public (Action<string> print, Action<Productos> increment) getTupla(string s, Productos p)
        {


            Action<string> a = s => Console.WriteLine(s);
            Action<Productos> pe = p => listaProductos.Add(p);
            return (a, pe);
        }


        public void agregarClienteAfter(List<Cliente> listaClientes, int Id)
        {
            if (!File.Exists(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, @"DataBaseUsers.xml"))) return;




            document.Element("Clientes").Elements("Cliente").Where
                (x => (int)x.Attribute("IdCliente") == Id).FirstOrDefault().
                AddAfterSelf(from cliente in listaClientes.ToArray()
                             select new
XElement("Cliente", new XAttribute("IdCliente", cliente.Id),
new XElement("Nombre", cliente.Name),
new XElement("Origen", cliente.Origen)));
        }

        public void agregarClienteBefore(List<Cliente> listaClientes, int Id)
        {
            if (!File.Exists(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, @"DataBaseUsers.xml"))) return;



            document.Element("Clientes").Elements("Cliente").Where
                (x => (int)x.Attribute("IdCliente") == Id).FirstOrDefault().
                AddAfterSelf(from cliente in listaClientes.ToArray()
                             select new
XElement("Cliente", new XAttribute("IdCliente", cliente.Id),
new XElement("Nombre", cliente.Name),
new XElement("Origen", cliente.Origen)));
        }

        public Cliente buscarCliente(int Id)
        {
            if (!File.Exists(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, @"DataBaseUsers.xml"))) return null;

            document.Element("Cliente").Elements("Clientes").w

        }

        public void editarCliente(int id,string elemento,string nuevoValor)
        {
            if (!File.Exists(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, @"DataBaseUsers.xml"))) throw new IOException("El archivo no existe");

            document.Element("Cliente").Elements("Clientes").Where(c => c.Attribute("IdCliente").Value == id.ToString()).
                FirstOrDefault().SetElementValue(elemento,nuevoValor);
        }


        
    }
}
